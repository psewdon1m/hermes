# 🚀 TGCall - Быстрый старт

## Что создано

✅ **Полноценная платформа видеозвонков** с WebRTC, P2P соединениями и TURN fallback  
✅ **Docker-контейнеризация** для легкого развертывания  
✅ **Интеграция с существующим nginx** (ваши сертификаты сохранены)  
✅ **Redis для хранения состояния** звонков  
✅ **Красивый современный интерфейс** с контролами  
✅ **Скрипты для генерации ссылок** на звонки  

## 🎯 Как запустить

### 1. Настройка окружения
```bash
# Скопировать шаблон .env файла
cp .env.example .env

# Отредактировать .env файл с вашими настройками
nano .env  # или любой другой редактор
```

### 2. Запуск сервисов
```bash
# Запустить все сервисы
docker-compose up -d
```

## 🔗 Создание звонка

После запуска используйте скрипт для создания ссылки:

```bash
node scripts/create-call.js
```

## 📋 Что нужно настроить перед деплоем

### Настройка .env файла
1. **Домен**: Обновите переменную `DOMAIN` в `.env` файле
2. **TURN сервер**: Настройте `TURN_USERNAME`, `TURN_PASSWORD`, `TURN_REALM` в `.env`
3. **SSL сертификаты**: Укажите пути в `SSL_CERT_PATH` и `SSL_KEY_PATH`
4. **Порты**: При необходимости измените порты в `.env` файле

### Важные переменные в .env:
- `DOMAIN` - ваш домен
- `SERVER_IP` - IP адрес сервера (38.180.153.25)
- `TURN_USERNAME` / `TURN_PASSWORD` - учетные данные TURN сервера
- `TURN_EXTERNAL_IP` - внешний IP для TURN сервера (38.180.153.25)
- `SSL_CERT_PATH` / `SSL_KEY_PATH` - пути к существующим SSL сертификатам
- `CALL_TIMEOUT_MINUTES` - время жизни звонка (по умолчанию 60 минут)

**Примечание**: TURN сервер использует те же SSL сертификаты, что и nginx.

## 🌐 Архитектура

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│  Frontend   │    │  Backend    │    │ TURN Server │
│  (React)    │◄──►│  (Node.js)  │◄──►│  (coturn)   │
└─────────────┘    └─────────────┘    └─────────────┘
       │                   │                   │
       │                   │                   │
       ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Nginx     │    │   Redis     │    │ SSL Certs   │
│  (Proxy)    │    │ (Storage)   │    │(Security)   │
└─────────────┘    └─────────────┘    └─────────────┘
```

## 🎮 Использование

1. **Создайте звонок**: `node scripts/create-call.js`
2. **Поделитесь ссылкой** с участником
3. **Откройте ссылку** в браузере
4. **Разрешите доступ** к камере/микрофону
5. **Наслаждайтесь звонком!**

## 🔧 Полезные команды

```bash
# Просмотр логов
docker-compose logs -f

# Остановка сервисов
docker-compose down

# Перезапуск
docker-compose restart

# Статус сервисов
docker-compose ps
```

## 📱 Особенности

- **P2P соединения** для лучшей производительности
- **TURN fallback** при проблемах с NAT
- **Автоочистка** звонков через 60 минут
- **Максимум 2 участника** на звонок
- **Современный UI** с контролами
- **Безопасность** через HTTPS и SSL

## 🆘 Если что-то не работает

1. Проверьте логи: `docker-compose logs`
2. Убедитесь, что порты свободны
3. Проверьте SSL сертификаты
4. Убедитесь, что домен настроен правильно

---

**Готово к деплою на сервер!** 🚀
